<template name="spells">
	<div fit>
		<div id="spells" class="scroll-y" fit>
			<div style="padding: 4px;"
				 layout horizontal start wrap>
				{{#if hasSlots}}
					<paper-shadow class="card"
								  style="margin: 4px;"
								  hero-id="main" {{detailHero}}>
						<div class="white top subhead"
							 layout horizontal center>
							Spell Slots
						</div>
						<div class="bottom list">
							{{#each levels}}{{#if showSlots ..}}
								<div class="item-slot">
									<div class="item spellSlot"
												hero-id="main" {{detailHero slotStatName ../_id}}
												layout horizontal center>
										<div style="margin-right: 16px">
											{{name}}
										</div>
										<div flex layout horizontal center>
											{{#each slotBubbles ..}}
												<paper-icon-button class="slotBubble"
																   icon={{icon}}
																   disabled={{disabled}}>
												</paper-icon-button>
											{{/each}}
										</div>
									</div>
								</div>
							{{/if}}{{/each}}
						</div>
					</paper-shadow>
				{{/if}}
				{{#each spellLists}}
					<paper-shadow class="card spellList" flex
								  hero-id="main" {{detailHero}}
								  style="margin: 4px;">
						<div class="top {{colorClass}}"
							 hero-id="toolbar" {{detailHero}}
							 layout horizontal center>
							 {{#if icon}}
 								<core-icon icon="rpg:{{icon}}" style="margin-right: 16px;"></core-icon>
 							{{/if}}
							<div flex>
								<div class="subhead">{{name}}</div>
								<div class="caption">
									{{#if saveDC}}
										<span style="margin-right: 16px;">
											Save DC: {{evaluate charId saveDC}}
										</span>
									{{/if}}
									{{#if attackBonus}}
										<span>
											Attack Bonus: {{evaluateSigned charId attackBonus}}
										</span>
									{{/if}}
								</div>
							</div>
							{{#if settings.showUnprepared}}
								{{#if maxPrepared}}
									<div class="subhead">
										{{numPrepared}} / {{evaluate charId maxPrepared}}
									</div>
								{{/if}}
								<core-tooltip label="Done"
											  position="left">
									<paper-icon-button class="finishPrep"
													   icon="done"
													   style="margin: -8px;">
									</paper-icon-button>
								</core-tooltip>
							{{else}}
								<core-tooltip label="Change prepared spells"
											  position="left">
									<paper-icon-button class="prepSpells"
													   disabled={{#unless canEditCharacter charId}}true{{/unless}}
													   icon="book"
													   style="margin: -8px;">
									</paper-icon-button>
								</core-tooltip>
							{{/if}}
						</div>
						<div class="bottom list column-container">
							{{#each levels}}
								{{#if spellCount .. ../../_id}}
								<div class="spellLevel">
									<div class="subhead">
										{{name}}
									</div>
									{{#each spells ../_id ../../_id}}
										{{#if showSpell ../../settings.showUnprepared}}
											<div class="item-slot">
												<div class="tall spell item"
													 hero-id="main" {{detailHero}}
													 layout horizontal center>
													<core-icon icon="{{#if icon}}rpg:{{icon}}{{else}}social:whatshot{{/if}}"
														       style="color: {{hexColor color}};
																      margin-right: 16px;">
													</core-icon>
													<div flex layout vertical>
														<div>{{name}}</div>
														<div class="caption">
															{{school}}
															{{castingTime}}
															{{#if ritual}}
																(ritual)
															{{/if}}
															{{#if spellComponents}}
																- {{spellComponents}}
															{{/if}}
														</div>
													</div>
													{{#if ../../settings.showUnprepared}}
														<paper-checkbox class="preparedCheckbox"
																		checked={{isPrepared}}
																		disabled={{cantUnprepare}}>
														</paper-checkbox>
													{{/if}}
												</div>
											</div>
										{{/if}}
									{{/each}}
								</div>
								{{/if}}
							{{/each}}
						</div>
					</paper-shadow>
				{{/each}}
			</div>
			<div class="fab-buffer"></div>
		</div>
	</div>
	{{#if canEditCharacter _id}}
		{{#fabMenu}}
			<core-tooltip label="New spell list" position="left">
				<paper-fab icon="work"
						   class="addSpellList"
						   mini>
				</paper-fab>
			</core-tooltip>
			<core-tooltip label="New spell" position="left">
				<paper-fab icon="note-add"
						   class="addSpell"
						   mini>
				</paper-fab>
			</core-tooltip>
		{{/fabMenu}}
	{{/if}}
</template>
