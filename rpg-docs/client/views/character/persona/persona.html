<template name="persona">
	<div fit>
		<div id="persona" class="scroll-y" fit>
			<div class="column-container">
				{{#with characterDetails}}
				<div>
					<paper-shadow class="card"
								  hero-id="main" {{detailHero "details" _id}}>
						{{#unless picture}}
							<div class="top subhead characterField {{colorClass}}"
								 hero-id="toolbar" {{detailHero "details" _id}}>
								<div class="subhead" flex
									 hero-id="title" {{detailHero "details" _id}}>
									{{name}}
								</div>
							</div>
						{{else}}
							<core-image class="characterField clickable"
										style="height:350px; width: 100%;
											   background-color: #e8e8e8;"
										sizing="cover"
										hero-id="image" {{detailHero "details" _id}}
										src={{picture}}></core-image>
						{{/unless}}
						<div class="bottom">
							{{#if picture}}
								<div class="title" hero-id="title" {{detailHero "details" _id}}>
									{{name}}
								</div>
							{{/if}}
							<div class="subhead">
								{{alignment}} {{gender}} {{race}}
							</div>
						</div>
					</paper-shadow>
				</div>
				{{/with}}
				<div>{{> containerCard charId=this._id field="description"}}</div>
				<div>{{> containerCard charId=this._id field="personality"}}</div>
				<div>{{> containerCard charId=this._id field="ideals"}}</div>
				<div>{{> containerCard charId=this._id field="bonds"}}</div>
				<div>{{> containerCard charId=this._id field="flaws"}}</div>
				<div>{{> containerCard charId=this._id field="backstory"}}</div>
				<div>
				<paper-shadow class="card">
                    <div class="white top subhead">
                      Languages
					</div>
					<div class="bottom list">
						{{#each languages}}
							{{> proficiencyListItem}}
						{{/each}}
					</div>
				</paper-shadow>
				</div>
			</div>
		</div>
	</div>
</template>

<template name="containerCard">
	{{#let f=(characterField charId field)}}
		{{#containerCardHelper
			charId=charId
			field=field
			color=f.color
			title=f.title
			topClass=f.topClass
			useMarkdown=true}}{{evaluateString _id f.body}}{{/containerCardHelper}}
	{{/let}}
</template>

<template name="containerCardHelper">
	<paper-shadow class="card {{class}}" hero-id="main"
		{{detailHero field charId}}>
	  <div class="top subhead {{colorClass color}} {{topClass}}" hero-id="toolbar"
			{{detailHero field charId}}>
			<div class="subhead" flex hero-id="title"
				{{detailHero field charId}}>
        {{title}}
      </div>
		</div>
		<div class="bottom">
			{{#if useMarkdown}}
				{{#markdown}}{{> UI.contentBlock}}{{/markdown}}
			{{else}}
				{{> UI.contentBlock}}
			{{/if}}
		</div>
	</paper-shadow>
</template>
