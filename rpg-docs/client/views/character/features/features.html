<template name="features">
	<div fit>
		<div class="scroll-y" fit>
			<div class="column-container">
				<!--expertiseDice-->
				{{>resource name="expertiseDice" title="Expertise Dice" color="teal" char=this}}
				<!--ki-->
				{{>resource name="ki" title="Ki Points" color="teal" char=this}}
				<!--rages-->
				{{>resource name="rages" title="Rages" color="teal" char=this}}
				<!--sorceryPoints-->
				{{>resource name="sorceryPoints" title="Sorcery Points" color="teal" char=this}}
				<!--superiorityDice-->
				{{>resource name="superiorityDice" title="Superiority Dice" color="teal" char=this}}
				
				<!--Attacks-->
				<paper-shadow class="card">
					<div class="top white">
						Attacks
					</div>
					<div class="bottom list">
						{{#each attacks}}
							<div class="item-slot">
								<div class="flexible attack item"
											hero-id="main" {{detailHero}}>
									<div layout horizontal>
										<div class="headline"
											 style="margin-right: 16px;"
											 layout horizontal center>
											{{evaluateSigned ../_id attackBonus}}
										</div>
										<div flex layout vertical>
											<div class="body2">
												{{name}}
											</div>
											<div>
												{{evaluateString ../_id damage}}&nbsp;{{damageType}}
											</div>
											{{#if details}}
												<div class="caption">
													{{details}}
												</div>
											{{/if}}
										</div>
									</div>
								</div>
							</div>
						{{/each}}
					</div>
				</paper-shadow>

				<!--Proficiencies-->
				<paper-shadow class="card">
					<div class="white top">
						Proficiencies
					</div>
					<div flex class="bottom list">
						{{#if weaponProfs.count}}
							<div class="subhead">Weapons</div>
						{{/if}}
						{{#each weaponProfs}}
							{{> proficiencyListItem}}
						{{/each}}
						{{#if armorProfs.count}}
							<div class="subhead">Armor</div>
						{{/if}}
						{{#each armorProfs}}
							{{> proficiencyListItem}}
						{{/each}}
						{{#if toolProfs.count}}
							<div class="subhead">Tools</div>
						{{/if}}
						{{#each toolProfs}}
							{{> proficiencyListItem}}
						{{/each}}
					</div>
				</paper-shadow>

				<!--features-->
				{{#each features}}
					<paper-shadow class="card featureCard"
								  hero-id="main" {{detailHero}}>
						<div class="top {{colorClass}} subhead" 
							 layout horizontal 
							 hero-id="toolbar" {{detailHero}}>
							<div flex hero-id="title" {{detailHero}}>
								{{name}}
							</div>
							{{#if hasUses}}
								<div style="margin-right: 8px">
									{{usesLeft}}/{{usesValue}}
								</div>
							{{/if}}
							{{#if canEnable}}
								<core-tooltip label="Feature enabled"
											  position="left">
									<paper-checkbox class="enabledCheckbox" 
													checked={{enabled}}
													disabled={{#unless canEditCharacter charId}}true{{/unless}}>
									</paper-checkbox>
								</core-tooltip>
							{{/if}}
						</div>
						{{#if description}}
							<div flex class="bottom">
								{{#markdown}}{{evaluateString charId shortDescription}}{{/markdown}}
							</div>
						{{/if}}
						{{#if hasUses}}
							<div layout horizontal center end-justified>
								<paper-button class="useFeature" 
											  disabled={{noUsesLeft}}>
									Use
								</paper-button>
								<paper-button class="resetFeature" 
											  disabled={{usesFull}}>
									Reset
								</paper-button>
							</div>
						{{/if}}
					</paper-shadow>
				{{/each}}
			</div>
			<div class="fab-buffer"></div>
		</div>
		{{#if canEditCharacter _id}}
			<paper-fab id="addFeature" 
					   class="floatyButton" 
					   icon="add" 
					   title="Add" 
					   role="button" 
					   tabindex="0" 
					   aria-label="Add" 
					   hero-id="main"></paper-fab>
		{{/if}}
	</div>
</template>

<template name="resource">
	{{#if characterCalculate "attributeBase" char._id name}}
		<paper-shadow class="card" 
					  hero-id="main" {{detailHero name char._id}}
					  layout horizontal>
			<div class="left {{getColor}} display1 white-text" 
				 hero-id="toolbar" {{detailHero name char._id}}
				 layout horizontal center>
				<div style="margin-right: 8px;">
					<paper-icon-button class="resourceUp" 
									   icon="arrow-drop-up" 
									   disabled={{cantIncrement}}>
					</paper-icon-button>
					<paper-icon-button class="resourceDown"
									   icon="arrow-drop-down"
									   disabled={{cantDecrement}}>
					</paper-icon-button>
				</div>
				<div>{{characterCalculate "attributeValue" char._id name}}</div>
				<!--<div>/{{char.attributeBase name}}</div>-->
			</div>
			<div class="right clickable" 
				 flex layout horizontal center>
				{{title}}
			</div>
		</paper-shadow>
	{{/if}}
</template>
